---
title: LC 856.括号的分数
tags: [字符串, 栈]
categories: Algorithm Solution
---

#### [856. 括号的分数](https://leetcode.cn/problems/score-of-parentheses/)

给定一个平衡括号字符串 `S`，按下述规则计算该字符串的分数：

- `()` 得 1 分。
- `AB` 得 `A + B` 分，其中 A 和 B 是平衡括号字符串。
- `(A)` 得 `2 * A` 分，其中 A 是平衡括号字符串。

 

**示例 1：**

```
输入： "()"
输出： 1
```

**示例 2：**

```
输入： "(())"
输出： 2
```

**示例 3：**

```
输入： "()()"
输出： 2
```

**示例 4：**

```
输入： "(()(()))"
输出： 6
```

 

**提示：**

1. `S` 是平衡括号字符串，且只含有 `(` 和 `)` 。
2. `2 <= S.length <= 50`

​	 

#### 栈

一般看到这种括号表达式的，基本跟栈八九不离十

栈可以用于存储括号的字符或者存储整数，这道题便是后者

当我们遍历到 `(` 时，我们将 0 压入栈中，表示**当前括号没有配对**，并且**栈顶元素表示所有括号表达式的总分是**

当我们遍历到 `)` 时，我们取栈顶元素 `cur` 并将其弹出，此时有两种情况

* 当 `cur == 0` 时，说明该括号前一个就是 `(` 并且可以**直接**与之配对，此时我们需要将 1 压入栈中
* 当 `cur != 0` 时，说明该括号内部有一个完整的括号表达式，那么整体的计算结果就是 `2 * cur` 

上面这两种情况可以用一个取最大值来替代，即 `max(2 * cur, 1)` 

此时我们还有第二个需求没有解决

我们看到，我们栈顶元素表示的是**所有括号表达式的分数**，那么我们在算完当前这个括号的分数之后，需要再加上前一次算出的分数才行，在栈中的表示就是需要加上前一个数，这样才能让栈顶元素表示所有括号表达式的分数

```cpp
class Solution {
public:
    int scoreOfParentheses(string s) 
    {
        stack<int>stk;
        stk.push(0);
        for(char c : s)
        {
            if(c == '(')
                stk.push(0);
            else
            {
                int cur = stk.top();
                stk.pop();
                int pre = stk.top();
                stk.pop();
                stk.push(pre + max(2 * cur, 1));
            }
        }
        return stk.top();
    }
};
```

时间复杂度：$O(n)$ 

空间复杂度：$O(n)$